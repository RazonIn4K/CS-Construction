# ====================================================================
# CD Home Improvements - Production Environment Configuration
# ====================================================================
# This file contains example configuration for PRODUCTION DEPLOYMENT
#
# CRITICAL SECURITY NOTES:
# 1. NEVER commit this file with real credentials to version control
# 2. Use LIVE API keys only (not test keys)
# 3. All passwords must be 32+ characters, randomly generated
# 4. Store credentials in secure password manager
# 5. Enable 2FA on all external services
# 6. Rotate credentials every 90 days
# ====================================================================

# ==================================
# Application Environment
# ==================================
NODE_ENV=production
NEXT_PUBLIC_APP_URL=https://cdhomeimprovementsrockford.com

# Vercel deployment (auto-set by Vercel)
VERCEL_ENV=production
VERCEL_URL=cdhomeimprovementsrockford.com

# ==================================
# Supabase Configuration (PRODUCTION)
# ==================================
# Get from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/api
NEXT_PUBLIC_SUPABASE_URL=https://YOUR_PRODUCTION_PROJECT.supabase.co
NEXT_PUBLIC_SUPABASE_ANON_KEY=YOUR_PRODUCTION_SUPABASE_ANON_KEY
SUPABASE_SERVICE_ROLE_KEY=YOUR_PRODUCTION_SUPABASE_SERVICE_ROLE_KEY

# Connection pooler for better performance (recommended)
DATABASE_URL=postgresql://postgres:PRODUCTION_PASSWORD@db.YOUR_PROJECT.supabase.co:6543/postgres?pgbouncer=true

# ==================================
# Stripe Configuration (LIVE MODE)
# ==================================
# Get from: https://dashboard.stripe.com/apikeys
# CRITICAL: Use LIVE keys (sk_live_... and pk_live_...)
NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=pk_live_51ProductionKey789...
STRIPE_SECRET_KEY=sk_live_51ProductionSecret789...

# Webhook secret from: https://dashboard.stripe.com/webhooks
# Endpoint: https://cdhomeimprovementsrockford.com/api/webhooks/stripe
STRIPE_WEBHOOK_SECRET=YOUR_PRODUCTION_STRIPE_WEBHOOK_SECRET

# ==================================
# Invoice Ninja Configuration (PRODUCTION)
# ==================================
# Production URL
INVOICENINJA_URL=https://portal.cdhomeimprovementsrockford.com

# API token from Invoice Ninja → Settings → API Tokens
# Generate new token, store securely
INVOICENINJA_API_TOKEN=PRODUCTION_API_TOKEN_32_CHARS_MIN

# Webhook verification secret (32+ char random string)
# Set this in both .env and Invoice Ninja webhook configuration
# Generate: openssl rand -hex 32
INVOICENINJA_WEBHOOK_SECRET=PRODUCTION_WEBHOOK_SECRET_64_CHARS_HEX

# ==================================
# n8n Configuration (PRODUCTION)
# ==================================
# Production n8n instance
N8N_WEBHOOK_BASE_URL=https://automate.cdhomeimprovementsrockford.com
N8N_WEBHOOK_LEAD_INTAKE=/webhook/lead-intake

# n8n API key (if using n8n API)
# Generate in n8n → Settings → API
N8N_API_KEY=PRODUCTION_N8N_API_KEY_32_CHARS_MIN

# ==================================
# Email Service (PRODUCTION)
# ==================================
# Choose ONE email provider

# Option 1: Postmark (Recommended for transactional emails)
EMAIL_PROVIDER=postmark
POSTMARK_SERVER_TOKEN=PRODUCTION_POSTMARK_TOKEN
EMAIL_FROM=noreply@cdhomeimprovementsrockford.com

# Option 2: SendGrid
# EMAIL_PROVIDER=sendgrid
# SENDGRID_API_KEY=SG.PRODUCTION_SENDGRID_API_KEY
# EMAIL_FROM=noreply@cdhomeimprovementsrockford.com

# Email configuration
EMAIL_REPLY_TO=info@cdhomeimprovementsrockford.com
EMAIL_SUPPORT=support@cdhomeimprovementsrockford.com

# ==================================
# SMS Service (PRODUCTION - Optional)
# ==================================
# Enable SMS notifications
ENABLE_SMS_NOTIFICATIONS=true

# Twilio Production Credentials
TWILIO_ACCOUNT_SID=AC_PRODUCTION_TWILIO_SID
TWILIO_AUTH_TOKEN=PRODUCTION_TWILIO_AUTH_TOKEN
TWILIO_PHONE_NUMBER=+18155551234  # Your Twilio number

# SMS notification settings
SMS_NOTIFY_ADMIN_ON_LEAD=true
SMS_ADMIN_NUMBER=+18155555678

# ==================================
# Sentry (Error Tracking - PRODUCTION)
# ==================================
# Get from: https://sentry.io/settings/YOUR_ORG/projects/cd-construction/keys/
NEXT_PUBLIC_SENTRY_DSN=https://PUBLIC_KEY@o000000.ingest.sentry.io/0000000
SENTRY_DSN=https://PUBLIC_KEY@o000000.ingest.sentry.io/0000000

# Sentry auth token for source maps
# Get from: https://sentry.io/settings/account/api/auth-tokens/
SENTRY_AUTH_TOKEN=PRODUCTION_SENTRY_AUTH_TOKEN

# Sentry project configuration
SENTRY_PROJECT=cd-construction-prod
SENTRY_ORG=cd-home-improvements

# Sentry sampling rates (adjust based on traffic)
SENTRY_TRACES_SAMPLE_RATE=0.1  # 10% of transactions
SENTRY_REPLAYS_SESSION_SAMPLE_RATE=0.1  # 10% of sessions
SENTRY_REPLAYS_ON_ERROR_SAMPLE_RATE=1.0  # 100% of errors

# ==================================
# Admin/Security (PRODUCTION)
# ==================================
# Generate with: openssl rand -hex 32
ADMIN_API_KEY=PRODUCTION_ADMIN_API_KEY_64_CHAR_HEX
ADMIN_REPLAY_SECRET=PRODUCTION_REPLAY_SECRET_64_CHAR_HEX

# JWT secret for admin authentication (if using)
# Generate with: openssl rand -base64 64
JWT_SECRET=PRODUCTION_JWT_SECRET_BASE64_ENCODED

# ==================================
# Rate Limiting (PRODUCTION)
# ==================================
# Rate limits per IP address
RATE_LIMIT_ENABLED=true
RATE_LIMIT_API_REQUESTS_PER_MINUTE=60
RATE_LIMIT_WEBHOOK_REQUESTS_PER_MINUTE=100
RATE_LIMIT_FORM_SUBMISSIONS_PER_HOUR=10

# ==================================
# Feature Flags (PRODUCTION)
# ==================================
# Enable production features
ENABLE_INVOICENINJA_WEBHOOK=true
ENABLE_SMS_NOTIFICATIONS=true
ENABLE_EMAIL_NOTIFICATIONS=true
ENABLE_PAYMENT_PROCESSING=true

# Maintenance mode (set to true during maintenance)
MAINTENANCE_MODE=false

# ==================================
# Monitoring & Analytics (PRODUCTION)
# ==================================
# Uptime monitoring
UPTIME_KUMA_URL=https://status.cdhomeimprovementsrockford.com

# Google Analytics (optional)
# NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX

# ==================================
# Security Headers (PRODUCTION)
# ==================================
# Content Security Policy
CSP_REPORT_URI=https://YOUR_ORG.report-uri.com/r/d/csp/enforce

# Allowed origins for CORS
ALLOWED_ORIGINS=https://cdhomeimprovementsrockford.com,https://www.cdhomeimprovementsrockford.com

# ==================================
# Backup Configuration (PRODUCTION)
# ==================================
# S3 bucket for offsite backups
AWS_ACCESS_KEY_ID=PRODUCTION_AWS_ACCESS_KEY
AWS_SECRET_ACCESS_KEY=PRODUCTION_AWS_SECRET_KEY
AWS_REGION=us-east-1
AWS_S3_BACKUP_BUCKET=cdhi-backups

# Backup retention (days)
BACKUP_RETENTION_DAYS=90

# ==================================
# VPS/Infrastructure (PRODUCTION)
# ==================================
# VPS IP address (for monitoring/reference)
VPS_IP_ADDRESS=123.456.789.012

# Docker host (if using remote Docker)
# DOCKER_HOST=tcp://123.456.789.012:2376

# ==================================
# Logging (PRODUCTION)
# ==================================
# Log level (error, warn, info, debug)
LOG_LEVEL=info

# Log to external service (optional)
# LOG_SERVICE=datadog
# DATADOG_API_KEY=PRODUCTION_DATADOG_KEY

# ==================================
# Performance Optimization (PRODUCTION)
# ==================================
# Enable caching
ENABLE_CACHING=true
CACHE_TTL_SECONDS=3600

# CDN configuration (if using)
# CDN_URL=https://cdn.cdhomeimprovementsrockford.com

# ==================================
# Compliance & Legal (PRODUCTION)
# ==================================
# Privacy policy URL
PRIVACY_POLICY_URL=https://cdhomeimprovementsrockford.com/privacy
TERMS_OF_SERVICE_URL=https://cdhomeimprovementsrockford.com/terms

# ==================================
# CRITICAL PRODUCTION CHECKLIST
# ==================================
#
# Before deploying to production, verify:
#
# ✅ Security:
# - [ ] All passwords are 32+ characters, randomly generated
# - [ ] Using LIVE API keys (not test keys)
# - [ ] All secrets stored in secure password manager
# - [ ] 2FA enabled on Vercel, Supabase, Stripe, GitHub
# - [ ] SSL certificates valid and auto-renewing
# - [ ] Firewall configured (UFW on VPS)
# - [ ] Fail2Ban active and configured
#
# ✅ Monitoring:
# - [ ] Sentry configured and receiving events
# - [ ] Uptime Kuma monitors configured
# - [ ] Email/SMS alerts configured
# - [ ] Backup verification automated
#
# ✅ Performance:
# - [ ] Database indexes created
# - [ ] Caching enabled
# - [ ] Image optimization enabled
# - [ ] CDN configured (optional)
#
# ✅ Compliance:
# - [ ] Privacy policy published
# - [ ] Terms of service published
# - [ ] Cookie consent implemented (if using cookies)
# - [ ] GDPR compliance reviewed (if applicable)
#
# ✅ Testing:
# - [ ] End-to-end tests passing
# - [ ] Load testing completed
# - [ ] Security audit completed
# - [ ] Backup restore tested
#
# ✅ Documentation:
# - [ ] All team members trained
# - [ ] Runbooks reviewed and updated
# - [ ] Emergency contacts documented
# - [ ] Rollback procedure tested
#
# ==================================
# EMERGENCY CONTACTS
# ==================================
#
# Technical Lead: [NAME] - [PHONE] - [EMAIL]
# On-Call Engineer: [NAME] - [PHONE] - [EMAIL]
# Business Owner: [NAME] - [PHONE] - [EMAIL]
#
# External Support:
# - Vercel: https://vercel.com/support
# - Supabase: https://supabase.com/support
# - Stripe: https://support.stripe.com/ or 1-888-926-2289
# - VPS Provider: [SUPPORT URL/PHONE]
#
# ==================================
# DEPLOYMENT NOTES
# ==================================
#
# Configure in Vercel:
# 1. Go to: https://vercel.com/YOUR_TEAM/cd-construction/settings/environment-variables
# 2. Add each variable above with "Production" environment selected
# 3. Never add secrets via git (use Vercel dashboard only)
# 4. After adding/updating variables, redeploy: vercel --prod
#
# Configure on VPS:
# 1. SSH into VPS: ssh root@YOUR_VPS_IP
# 2. Edit .env: nano /opt/cdhi-stack/docker/.env
# 3. Set permissions: chmod 600 /opt/cdhi-stack/docker/.env
# 4. Restart services: docker-compose up -d --force-recreate
#
# Credential Rotation Schedule:
# - Every 90 days: Database passwords, API keys
# - Every 180 days: SSH keys, admin passwords
# - Immediately: If breach suspected or team member leaves
#
# ====================================================================
